[2023-09-21T00:13:27.112+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T00:13:18.979407+00:00 [queued]>
[2023-09-21T00:13:27.120+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T00:13:18.979407+00:00 [queued]>
[2023-09-21T00:13:27.120+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2023-09-21T00:13:27.131+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): send_to_snowflake> on 2023-09-21 00:13:18.979407+00:00
[2023-09-21T00:13:27.137+0000] {standard_task_runner.py:57} INFO - Started process 1427 to run task
[2023-09-21T00:13:27.139+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'student_semantic', 'send_to_snowflake', 'manual__2023-09-21T00:13:18.979407+00:00', '--job-id', '333', '--raw', '--subdir', 'DAGS_FOLDER/student_semantic.py', '--cfg-path', '/tmp/tmpf1tv9224']
[2023-09-21T00:13:27.141+0000] {standard_task_runner.py:85} INFO - Job 333: Subtask send_to_snowflake
[2023-09-21T00:13:27.178+0000] {task_command.py:415} INFO - Running <TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T00:13:18.979407+00:00 [running]> on host f143046c8e98
[2023-09-21T00:13:27.239+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='student_semantic' AIRFLOW_CTX_TASK_ID='send_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2023-09-21T00:13:18.979407+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-09-21T00:13:18.979407+00:00'
[2023-09-21T00:13:27.241+0000] {connection.py:314} INFO - Snowflake Connector for Python Version: 3.1.1, Python Version: 3.8.18, Platform: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.2.5
[2023-09-21T00:13:27.241+0000] {connection.py:1050} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2023-09-21T00:13:27.241+0000] {connection.py:1068} INFO - Setting use_openssl_only mode to False
[2023-09-21T00:13:30.333+0000] {ocsp_snowflake.py:1067} ERROR - WARNING!!! Using fail-open to connect. Driver is connecting to an HTTPS endpoint without OCSP based Certificate Revocation checking as it could not obtain a valid OCSP Response to use from the CA OCSP responder. Details: 
 {'driver': 'PythonConnector', 'version': '3.1.1', 'eventType': 'RevocationCheckFailure', 'eventSubType': 'OCSPResponseExpired', 'sfcPeerHost': 'hc45535.snowflakecomputing.com', 'certId': 'MEowBwYFKw4DAhoEFE9Zo5RTz7lVnn9r2MVNpT2mQrcUBBSEGMyFNOy8DJSULghZnMeyEE4KCAITB3MSSkvL1E7HtTvq8ZSELToPoQ==', 'ocspRequestBase64': 'MFIwUDBOMEwwSjAHBgUrDgMCGgQUT1mjlFPPuVWef2vYxU2lPaZCtxQEFIQYzIU07LwMlJQuCFmcx7IQTgoIAhMHcxJKS8vUTse1O+rxlIQtOg+h', 'ocspResponderURL': 'http://ocsp.rootca1.amazontrust.com', 'errorMessage': '254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:36Z, next_update=2023-09-28 02:36:36Z, tolerable next_update=2023-09-28 04:18:00Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time. Consider running curl -o ocsp.der http://ocsp.rootca1.amazontrust.com/MFIwUDBOMEwwSjAHBgUrDgMCGgQUT1mjlFPPuVWef2vYxU2lPaZCtxQEFIQYzIU07LwMlJQuCFmcx7IQTgoIAhMHcxJKS8vUTse1O+rxlIQtOg+h', 'insecureMode': False, 'failOpen': True, 'cacheEnabled': True, 'cacheHit': False, 'exceptionMessage': '254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:36Z, next_update=2023-09-28 02:36:36Z, tolerable next_update=2023-09-28 04:18:00Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time. Consider running curl -o ocsp.der http://ocsp.rootca1.amazontrust.com/MFIwUDBOMEwwSjAHBgUrDgMCGgQUT1mjlFPPuVWef2vYxU2lPaZCtxQEFIQYzIU07LwMlJQuCFmcx7IQTgoIAhMHcxJKS8vUTse1O+rxlIQtOg+h', 'exceptionStackTrace': 'Traceback (most recent call last):\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_asn1crypto.py", line 361, in process_ocsp_response\n    self._process_good_status(single_response, cert_id, ocsp_response)\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_snowflake.py", line 1548, in _process_good_status\n    raise RevocationCheckError(\nsnowflake.connector.errors.RevocationCheckError: 254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:36Z, next_update=2023-09-28 02:36:36Z, tolerable next_update=2023-09-28 04:18:00Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_snowflake.py", line 1119, in validate_by_direct_connection\n    raise op_er\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_snowflake.py", line 1113, in validate_by_direct_connection\n    self.process_ocsp_response(issuer, cert_id, ocsp_response)\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_asn1crypto.py", line 378, in process_ocsp_response\n    raise RevocationCheckError(msg=debug_msg, errno=op_er.errno)\nsnowflake.connector.errors.RevocationCheckError: 254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:36Z, next_update=2023-09-28 02:36:36Z, tolerable next_update=2023-09-28 04:18:00Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time. Consider running curl -o ocsp.der http://ocsp.rootca1.amazontrust.com/MFIwUDBOMEwwSjAHBgUrDgMCGgQUT1mjlFPPuVWef2vYxU2lPaZCtxQEFIQYzIU07LwMlJQuCFmcx7IQTgoIAhMHcxJKS8vUTse1O+rxlIQtOg+h\n'}
[2023-09-21T00:13:30.904+0000] {ocsp_snowflake.py:1067} ERROR - WARNING!!! Using fail-open to connect. Driver is connecting to an HTTPS endpoint without OCSP based Certificate Revocation checking as it could not obtain a valid OCSP Response to use from the CA OCSP responder. Details: 
 {'driver': 'PythonConnector', 'version': '3.1.1', 'eventType': 'RevocationCheckFailure', 'eventSubType': 'OCSPResponseExpired|OCSPResponseExpired', 'sfcPeerHost': 'hc45535.snowflakecomputing.com', 'certId': 'MEowBwYFKw4DAhoEFIh9pEReZ+p8lHdOQxicPs7kyHMSBBScXwDfqgHXMCs4iKK4bUqc8hGRgwITBn+USionzfP6wq4rAfkI7rnExg==', 'ocspRequestBase64': 'MFIwUDBOMEwwSjAHBgUrDgMCGgQUiH2kRF5n6nyUd05DGJw+zuTIcxIEFJxfAN+qAdcwKziIorhtSpzyEZGDAhMGf5RKKifN8/rCrisB+QjuucTG', 'ocspResponderURL': 'http://ocsp.rootg2.amazontrust.com', 'errorMessage': '254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:37Z, next_update=2023-09-28 02:36:37Z, tolerable next_update=2023-09-28 04:18:01Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time. Consider running curl -o ocsp.der http://ocsp.rootg2.amazontrust.com/MFIwUDBOMEwwSjAHBgUrDgMCGgQUiH2kRF5n6nyUd05DGJw+zuTIcxIEFJxfAN+qAdcwKziIorhtSpzyEZGDAhMGf5RKKifN8/rCrisB+QjuucTG', 'insecureMode': False, 'failOpen': True, 'cacheEnabled': True, 'cacheHit': False, 'exceptionMessage': '254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:37Z, next_update=2023-09-28 02:36:37Z, tolerable next_update=2023-09-28 04:18:01Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time. Consider running curl -o ocsp.der http://ocsp.rootg2.amazontrust.com/MFIwUDBOMEwwSjAHBgUrDgMCGgQUiH2kRF5n6nyUd05DGJw+zuTIcxIEFJxfAN+qAdcwKziIorhtSpzyEZGDAhMGf5RKKifN8/rCrisB+QjuucTG', 'exceptionStackTrace': 'Traceback (most recent call last):\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_asn1crypto.py", line 361, in process_ocsp_response\n    self._process_good_status(single_response, cert_id, ocsp_response)\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_snowflake.py", line 1548, in _process_good_status\n    raise RevocationCheckError(\nsnowflake.connector.errors.RevocationCheckError: 254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:37Z, next_update=2023-09-28 02:36:37Z, tolerable next_update=2023-09-28 04:18:01Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_snowflake.py", line 1119, in validate_by_direct_connection\n    raise op_er\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_snowflake.py", line 1113, in validate_by_direct_connection\n    self.process_ocsp_response(issuer, cert_id, ocsp_response)\n  File "/home/***/.local/lib/python3.8/site-packages/snowflake/connector/ocsp_asn1crypto.py", line 378, in process_ocsp_response\n    raise RevocationCheckError(msg=debug_msg, errno=op_er.errno)\nsnowflake.connector.errors.RevocationCheckError: 254013: 254013: Response is unreliable. Its validity date is out of range: current_time=2023-09-21 00:13:30Z, this_update=2023-09-21 01:36:37Z, next_update=2023-09-28 02:36:37Z, tolerable next_update=2023-09-28 04:18:01Z. A potential cause is client clock is skewed, CA fails to update OCSP response in time. Consider running curl -o ocsp.der http://ocsp.rootg2.amazontrust.com/MFIwUDBOMEwwSjAHBgUrDgMCGgQUiH2kRF5n6nyUd05DGJw+zuTIcxIEFJxfAN+qAdcwKziIorhtSpzyEZGDAhMGf5RKKifN8/rCrisB+QjuucTG\n'}
[2023-09-21T00:13:31.218+0000] {taskinstance.py:1935} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 730, in _post_request
    ret = self.fetch(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 849, in fetch
    ret = self._request_exec_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 987, in _request_exec_wrapper
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 891, in _request_exec_wrapper
    return_object = self._request_exec(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1189, in _request_exec
    raise err
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1110, in _request_exec
    raise ForbiddenError
snowflake.connector.errors.ForbiddenError: HTTP 403: Forbidden

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/packages/student_semantic/student_semantic.py", line 154, in send_to_snowflake
    conn = snowflake.connector.connect(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 51, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 353, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 625, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 898, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1167, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1193, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 259, in authenticate
    raise err.__class__(
snowflake.connector.errors.ForbiddenError: 250001 (08001): None: Failed to connect to DB. Verify the account name is correct: hc45535.snowflakecomputing.com:443. HTTP 403: Forbidden
[2023-09-21T00:13:31.227+0000] {taskinstance.py:1398} INFO - Marking task as FAILED. dag_id=student_semantic, task_id=send_to_snowflake, execution_date=20230921T001318, start_date=20230921T001327, end_date=20230921T001331
[2023-09-21T00:13:31.240+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 333 for task send_to_snowflake (250001 (08001): None: Failed to connect to DB. Verify the account name is correct: hc45535.snowflakecomputing.com:443. HTTP 403: Forbidden; 1427)
[2023-09-21T00:13:31.260+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-09-21T00:13:31.273+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
