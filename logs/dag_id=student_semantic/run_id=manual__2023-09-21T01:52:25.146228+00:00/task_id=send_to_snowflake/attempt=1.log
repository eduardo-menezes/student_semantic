[2023-09-21T01:52:31.125+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T01:52:25.146228+00:00 [queued]>
[2023-09-21T01:52:31.131+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T01:52:25.146228+00:00 [queued]>
[2023-09-21T01:52:31.132+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2023-09-21T01:52:31.142+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): send_to_snowflake> on 2023-09-21 01:52:25.146228+00:00
[2023-09-21T01:52:31.147+0000] {standard_task_runner.py:57} INFO - Started process 2578 to run task
[2023-09-21T01:52:31.150+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'student_semantic', 'send_to_snowflake', 'manual__2023-09-21T01:52:25.146228+00:00', '--job-id', '497', '--raw', '--subdir', 'DAGS_FOLDER/student_semantic.py', '--cfg-path', '/tmp/tmpnhlatv6w']
[2023-09-21T01:52:31.152+0000] {standard_task_runner.py:85} INFO - Job 497: Subtask send_to_snowflake
[2023-09-21T01:52:31.188+0000] {task_command.py:415} INFO - Running <TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T01:52:25.146228+00:00 [running]> on host fd67d4db30a8
[2023-09-21T01:52:31.246+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='student_semantic' AIRFLOW_CTX_TASK_ID='send_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2023-09-21T01:52:25.146228+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-09-21T01:52:25.146228+00:00'
[2023-09-21T01:52:31.290+0000] {connection.py:314} INFO - Snowflake Connector for Python Version: 3.1.1, Python Version: 3.8.18, Platform: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.2.5
[2023-09-21T01:52:31.291+0000] {connection.py:1050} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2023-09-21T01:52:31.291+0000] {connection.py:1060} INFO - THIS CONNECTION IS IN INSECURE MODE. IT MEANS THE CERTIFICATE WILL BE VALIDATED BUT THE CERTIFICATE REVOCATION STATUS WILL NOT BE CHECKED.
[2023-09-21T01:52:31.291+0000] {connection.py:1068} INFO - Setting use_openssl_only mode to False
[2023-09-21T01:52:31.376+0000] {ssl_wrap_socket.py:100} INFO - THIS CONNECTION IS IN INSECURE MODE. IT MEANS THE CERTIFICATE WILL BE VALIDATED BUT THE CERTIFICATE REVOCATION STATUS WILL NOT BE CHECKED.
[2023-09-21T01:52:31.819+0000] {cursor.py:804} INFO - query: [select current_database(), current_schema();]
[2023-09-21T01:52:32.058+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:52:32.059+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:52:32.059+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2023-09-21T01:52:32.289+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:52:32.289+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:52:32.290+0000] {cursor.py:804} INFO - query: [USE ROLE ACCOUNTADMIN;  CREATE OR REPLACE TABLE STUDENT_DATA( student_id VARCHAR...]
[2023-09-21T01:52:32.525+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:52:32.532+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2023-09-21T01:52:33.091+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:52:33.091+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:52:33.091+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2023-09-21T01:52:33.316+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:52:33.316+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:52:33.317+0000] {taskinstance.py:1935} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 908, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000008 (0A000): 01af211f-0001-577b-0000-0002581ae249: Actual statement count 2 did not match the desired statement count 1.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/packages/student_semantic/student_semantic.py", line 200, in send_to_snowflake
    con.execute(sql)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1370, in execute
    return self._exec_driver_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1674, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 908, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
sqlalchemy.exc.ProgrammingError: (snowflake.connector.errors.ProgrammingError) 000008 (0A000): 01af211f-0001-577b-0000-0002581ae249: Actual statement count 2 did not match the desired statement count 1.
[SQL: 
        USE ROLE ACCOUNTADMIN;

        CREATE OR REPLACE TABLE STUDENT_DATA(
        student_id VARCHAR, 
        name VARCHAR, 
        grades_math INTEGER,
        grades_science INTEGER,
        grades_history INTEGER,
        grades_english INTEGER,
        missed_days INTEGER);

        ]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2023-09-21T01:52:33.323+0000] {taskinstance.py:1398} INFO - Marking task as FAILED. dag_id=student_semantic, task_id=send_to_snowflake, execution_date=20230921T015225, start_date=20230921T015231, end_date=20230921T015233
[2023-09-21T01:52:33.333+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 497 for task send_to_snowflake ((snowflake.connector.errors.ProgrammingError) 000008 (0A000): 01af211f-0001-577b-0000-0002581ae249: Actual statement count 2 did not match the desired statement count 1.
[SQL: 
        USE ROLE ACCOUNTADMIN;

        CREATE OR REPLACE TABLE STUDENT_DATA(
        student_id VARCHAR, 
        name VARCHAR, 
        grades_math INTEGER,
        grades_science INTEGER,
        grades_history INTEGER,
        grades_english INTEGER,
        missed_days INTEGER);

        ]
(Background on this error at: https://sqlalche.me/e/14/f405); 2578)
[2023-09-21T01:52:33.376+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-09-21T01:52:33.391+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
