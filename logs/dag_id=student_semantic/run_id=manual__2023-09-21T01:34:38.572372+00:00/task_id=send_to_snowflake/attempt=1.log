[2023-09-21T01:34:44.255+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T01:34:38.572372+00:00 [queued]>
[2023-09-21T01:34:44.261+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T01:34:38.572372+00:00 [queued]>
[2023-09-21T01:34:44.262+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2023-09-21T01:34:44.272+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): send_to_snowflake> on 2023-09-21 01:34:38.572372+00:00
[2023-09-21T01:34:44.277+0000] {standard_task_runner.py:57} INFO - Started process 2042 to run task
[2023-09-21T01:34:44.280+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'student_semantic', 'send_to_snowflake', 'manual__2023-09-21T01:34:38.572372+00:00', '--job-id', '461', '--raw', '--subdir', 'DAGS_FOLDER/student_semantic.py', '--cfg-path', '/tmp/tmpltgznaqt']
[2023-09-21T01:34:44.282+0000] {standard_task_runner.py:85} INFO - Job 461: Subtask send_to_snowflake
[2023-09-21T01:34:44.319+0000] {task_command.py:415} INFO - Running <TaskInstance: student_semantic.send_to_snowflake manual__2023-09-21T01:34:38.572372+00:00 [running]> on host fd67d4db30a8
[2023-09-21T01:34:44.389+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='student_semantic' AIRFLOW_CTX_TASK_ID='send_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2023-09-21T01:34:38.572372+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-09-21T01:34:38.572372+00:00'
[2023-09-21T01:34:44.428+0000] {logging_mixin.py:151} INFO -    student_id              name  ...  grades_english  missed_days
0        S001     Alice Johnson  ...              92            3
1        S002         Bob Smith  ...              90            5
2        S003     Charlie Brown  ...              94            2
3        S004         David Lee  ...              88            1
4        S005      Eva Martinez  ...              92            4
5        S006      Frank Wilson  ...              76            2
6        S007       Grace Adams  ...              85            3
7        S008      Hannah White  ...              81            1
8        S009          Ian Hall  ...              90            6
9        S010    Jessica Turner  ...              92            3
10       S011      Kevin Parker  ...              76            4
11       S012      Linda Brooks  ...              85            2
12       S013     Michael Green  ...              81            5
13       S014     Natalie Adams  ...              90            3
14       S015     Olivia Foster  ...              92            2
15       S016      Peter Turner  ...              76            4
16       S017     Quincy Parker  ...              85            3
17       S018       Rachel Hall  ...              81            1
18       S019     Samuel Brooks  ...              90            2
19       S020      Taylor Green  ...              92            5
20       S021         Uma Adams  ...              76            3
21       S022     Victor Turner  ...              85            4
22       S023        Wendy Hall  ...              81            2
23       S024     Xander Brooks  ...              90            1
24       S025        Yara Green  ...              92            5
25       S026     Zachary Adams  ...              76            2
26       S027        Ava Turner  ...              85            3
27       S028     Benjamin Hall  ...              81            4
28       S029  Catherine Brooks  ...              90            2
29       S030      Daniel Green  ...              92            1
30       S031       Emily Adams  ...              76            3
31       S032       Finn Turner  ...              85            5
32       S033        Grace Hall  ...              81            2
33       S034      Henry Brooks  ...              90            4
34       S035    Isabella Green  ...              92            3
35       S036       Jacob Adams  ...              76            1
36       S037  Katherine Turner  ...              85            2
37       S038         Liam Hall  ...              81            5
38       S039        Mia Brooks  ...              90            3
39       S040        Noah Green  ...              92            4
40       S041      Olivia Adams  ...              76            2
41       S042      Peter Turner  ...              85            1
42       S043       Quincy Hall  ...              81            5
43       S044     Rachel Brooks  ...              90            3
44       S045      Samuel Green  ...              92            2
45       S046      Taylor Adams  ...              76            4
46       S047        Uma Turner  ...              85            3
47       S048       Victor Hall  ...              81            1
48       S049      Wendy Brooks  ...              90            2
49       S050      Xander Green  ...              92            5

[50 rows x 7 columns]
[2023-09-21T01:34:44.437+0000] {connection.py:314} INFO - Snowflake Connector for Python Version: 3.1.1, Python Version: 3.8.18, Platform: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.2.5
[2023-09-21T01:34:44.438+0000] {connection.py:1050} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2023-09-21T01:34:44.438+0000] {connection.py:1060} INFO - THIS CONNECTION IS IN INSECURE MODE. IT MEANS THE CERTIFICATE WILL BE VALIDATED BUT THE CERTIFICATE REVOCATION STATUS WILL NOT BE CHECKED.
[2023-09-21T01:34:44.438+0000] {connection.py:1068} INFO - Setting use_openssl_only mode to False
[2023-09-21T01:34:44.534+0000] {ssl_wrap_socket.py:100} INFO - THIS CONNECTION IS IN INSECURE MODE. IT MEANS THE CERTIFICATE WILL BE VALIDATED BUT THE CERTIFICATE REVOCATION STATUS WILL NOT BE CHECKED.
[2023-09-21T01:34:45.114+0000] {cursor.py:804} INFO - query: [select current_database(), current_schema();]
[2023-09-21T01:34:45.342+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:45.343+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:45.345+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2023-09-21T01:34:45.556+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:45.557+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:45.562+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ student_data]
[2023-09-21T01:34:45.794+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:45.795+0000] {cursor.py:959} INFO - Number of results in first chunk: 7
[2023-09-21T01:34:45.796+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ student_data]
[2023-09-21T01:34:46.028+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:46.028+0000] {cursor.py:959} INFO - Number of results in first chunk: 7
[2023-09-21T01:34:46.029+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN student_semantic]
[2023-09-21T01:34:46.278+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:46.279+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:46.280+0000] {cursor.py:804} INFO - query: [select current_database(), current_schema();]
[2023-09-21T01:34:46.516+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:46.516+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:46.517+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:_get_schema_primary_keys */PRIMARY KEYS IN SCHEMA student_sem...]
[2023-09-21T01:34:46.738+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:46.739+0000] {cursor.py:959} INFO - Number of results in first chunk: 0
[2023-09-21T01:34:46.740+0000] {cursor.py:804} INFO - query: [SELECT /* sqlalchemy:_get_schema_columns */ ic.table_name, ic.column_name, ic.da...]
[2023-09-21T01:34:48.558+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:48.559+0000] {cursor.py:959} INFO - Number of results in first chunk: 7
[2023-09-21T01:34:48.560+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:_get_schema_foreign_keys */ IMPORTED KEYS IN SCHEMA student_s...]
[2023-09-21T01:34:48.807+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:48.808+0000] {cursor.py:959} INFO - Number of results in first chunk: 0
[2023-09-21T01:34:48.809+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:_get_schema_unique_constraints */ UNIQUE KEYS IN SCHEMA stude...]
[2023-09-21T01:34:49.032+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:49.033+0000] {cursor.py:959} INFO - Number of results in first chunk: 0
[2023-09-21T01:34:49.034+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:_get_table_comment */ TABLES LIKE 'student_data']
[2023-09-21T01:34:49.279+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:49.280+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:49.281+0000] {cursor.py:804} INFO - query: [DROP TABLE student_data]
[2023-09-21T01:34:49.566+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:49.567+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:49.568+0000] {cursor.py:804} INFO - query: [CREATE TABLE student_data ( student_id TEXT, name TEXT, grades_math BIGINT, grad...]
[2023-09-21T01:34:49.863+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:49.864+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:49.865+0000] {cursor.py:804} INFO - query: [CREATE TEMP STAGE /* Python:snowflake.connector.pandas_tools.write_pandas() */ "...]
[2023-09-21T01:34:50.106+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:50.106+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:50.110+0000] {cursor.py:804} INFO - query: [PUT /* Python:snowflake.connector.pandas_tools.write_pandas() */ 'file:///tmp/tm...]
[2023-09-21T01:34:50.418+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:50.837+0000] {ssl_wrap_socket.py:100} INFO - THIS CONNECTION IS IN INSECURE MODE. IT MEANS THE CERTIFICATE WILL BE VALIDATED BUT THE CERTIFICATE REVOCATION STATUS WILL NOT BE CHECKED.
[2023-09-21T01:34:51.790+0000] {cursor.py:804} INFO - query: [COPY INTO "STUDENT_DATA" /* Python:snowflake.connector.pandas_tools.write_pandas...]
[2023-09-21T01:34:52.021+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:52.029+0000] {cursor.py:804} INFO - query: [COMMIT]
[2023-09-21T01:34:52.229+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:52.230+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:52.230+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2023-09-21T01:34:52.431+0000] {cursor.py:817} INFO - query execution done
[2023-09-21T01:34:52.432+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2023-09-21T01:34:52.432+0000] {taskinstance.py:1935} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/packages/student_semantic/student_semantic.py", line 175, in send_to_snowflake
    df_student.to_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 2878, in to_sql
    return sql.to_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 769, in to_sql
    return pandas_sql.to_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1920, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1461, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1023, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/pandas_tools.py", line 499, in pd_writer
    write_pandas(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/pandas_tools.py", line 388, in write_pandas
    copy_results = cursor.execute(copy_into_sql, _is_internal=True).fetchall()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 908, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): 01af210d-0001-5715-0000-0002581a6299: SQL compilation error: error line 1 at position 87
invalid identifier '"student_id"'
[2023-09-21T01:34:52.438+0000] {taskinstance.py:1398} INFO - Marking task as FAILED. dag_id=student_semantic, task_id=send_to_snowflake, execution_date=20230921T013438, start_date=20230921T013444, end_date=20230921T013452
[2023-09-21T01:34:52.451+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 461 for task send_to_snowflake (000904 (42000): 01af210d-0001-5715-0000-0002581a6299: SQL compilation error: error line 1 at position 87
invalid identifier '"student_id"'; 2042)
[2023-09-21T01:34:52.499+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-09-21T01:34:52.512+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
